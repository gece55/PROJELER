from kivy.lang import Builder
from kivymd.app import MDApp
from kivy.uix.screenmanager import Screen,ScreenManager
from kivymd.uix.snackbar import Snackbar
from kivymd.uix.boxlayout import MDBoxLayout
from kivy.uix.widget import Widget
from kivy.graphics import Rectangle,Ellipse
from kivy.graphics import Color
from kivy.utils import get_color_from_hex
from kivymd.uix.floatlayout import MDFloatLayout
from kivymd.uix.behaviors import FakeRectangularElevationBehavior
import sqlite3
from kivy.core.window import Window
from kivy.metrics import dp


class Touch(MDFloatLayout,FakeRectangularElevationBehavior):
    pass

          
   
class Test(MDApp):
    
    def build(self):
        global ekran
        ekran=ScreenManager()
        ekran.add_widget(Builder.load_file("ee.kv"))
        ekran.add_widget(Builder.load_file("slj.kv"))
        return ekran 
    
    def sifre(self):
       if ekran.get_screen("sayfa").ids.password.password==True:
          ekran.get_screen("sayfa").ids.password.password=False
          ekran.get_screen("sayfa").ids.l.icon="eye"
       else:
            ekran.get_screen("sayfa").ids.password.password=True
            ekran.get_screen("sayfa").ids.l.icon="eye-off"

    def giris(self,user,password):
        conn = sqlite3.connect('son.db')   #İD EKLEME
        x=conn.cursor()
        x.execute(" select * from COMPANY")
        veri=x.fetchall()
        for i in veri:
            if i[:][1]==user:
                    if i[:][2]==int(password):
                        ekran.current="zort"
                    else:
                        Snackbar(
                                text="hata var",
                                snackbar_x="10dp",
                                snackbar_y="10dp",
                                size_hint_x=(
                                    Window.width - (dp(10) * 2)
                                ) / Window.width
                            ).open()
    def temizle(self):
        ekran.get_screen("sayfa").ids.password.text=" "
        ekran.get_screen("sayfa").ids.password.password=False #buda zorunlu 
        ekran.get_screen("sayfa").ids.user.text=" "

Test().run()

#kivy
#:import get_color_from_hex kivy.utils.get_color_from_hex 
MDScreen:
    name:"sayfa"
    Touch:
        elevation:10
        pos_hint:{"center_x":.5,"center_y":.5}
        size_hint:.50,.50
        #kenarlık yapma 
        canvas.before:
            Color:
                rgba: (1,0,0, 1)
            RoundedRectangle:
                size: self.size
                pos: self.pos
                radius: [15]
                source:"pencere.jpg"
            Color:
                rgba: (253/255, 245/255, 230/255, 1)
            RoundedRectangle:
                size: self.width-20, self.height-20
                pos: self.x+10, self.y+10
                
        MDLabel:
            markup:True
            text: "HOŞ GELDİNİZ"   #[color=#baa2bd] [size=35]L[/size]
            font_name:"Constani.ttf"
            pos_hint: {"center_x": 0.50, "center_y":0.90}
            theme_text_color: "Secondary"
            halign:"center" 
            id:label      
        MDTextFieldRound:
            id:user
            hint_text:"kullanıcı ismi"
            icon_right:"account"
            pos_hint: {"center_x": 0.50, "center_y":0.75}
            size_hint_x:.45
            #width:200
            font_size:18

        #şifre kısmı
        MDTextFieldRound:
            id:password
            hint_text:"şifre"
            #icon_right:"eye-off"
            pos_hint: {"center_x": 0.50, "center_y":0.55}
            size_hint_x:.45
            #width:200
            font_size:18
            password:True

        MDIconButton:
            icon: "eye"
            pos_hint: {"center_x": 0.67, "center_y":0.55}
            on_release:app.sifre()
            opacity:.5 #görüürlük %50 oldu
            id:l
            

        MDRoundFlatButton:
            text:"temizle"
            pos_hint: {"center_x": 0.35, "center_y":0.25}
            font_size:12
            on_release:app.giris(user.text,password.text)
            
          
        
        MDRoundFlatButton:
            text:"sil"
            pos_hint: {"center_x": 0.65, "center_y":0.25}
            font_size:12
            on_release:app.temizle()
